#!/bin/bash

set -eux

# TODO: This script is a hack. We need to find another way to vendor node modules.
pushd ${BUILD_DIR}/github.com/vmware/harbor/src/ui_ng

# Set offline mirror directory
mkdir yarn-offine-cache
cat > .yarnrc <<EOF
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1

lastUpdateCheck $(date +%s000)
yarn-offline-mirror "${BUILD_DIR}/github.com/vmware/harbor/src/ui_ng/yarn-offine-cache"
EOF

# Install dependencies
yarn install --non-interactive

popd
